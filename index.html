<!doctype html>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Open Zumba Registration</title>
<style>
  body{font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial;background:#fafafa;margin:0}
  .card{max-width:520px;margin:40px auto;background:#fff;border:1px solid #eee;border-radius:16px;box-shadow:0 1px 4px rgba(0,0,0,.04);padding:24px}
  button{display:inline-block;padding:12px 16px;background:#111;color:#fff;border:0;border-radius:12px;font-weight:700;cursor:pointer}
  .muted{color:#666;font-size:14px;margin-top:12px}
  .row{display:flex;gap:12px;flex-wrap:wrap}
</style>

<div class="card">
  <h2>Open Zumba Registration</h2>
  <p>Tap a button below.</p>

  <!-- Strongest signal: form submit -->
  <div class="row">
    <form id="openForm" action="GAS_URL" method="get" target="_self">
      <button type="submit">Open Registration</button>
    </form>
    <form id="adminForm" action="GAS_URL" method="get" target="_self">
      <input type="hidden" name="admin" value="1">
      <button type="submit">Admin</button>
    </form>
  </div>

  <!-- Manual link backstop -->
  <p class="muted">If you tapped “Always allow” and the screen is blank, tap the button again.
    If it still doesn’t open, use this link: <a id="manual" href="GAS_URL">Open Registration</a></p>
</div>

<script>
  // If a webview blocks then "Always allow" is tapped, it may not resume.
  // We add a timed retry after the first click/submit.
  const GAS = 'GAS_URL';
  let pending = false;

  function retryNav() {
    if (!pending) return;
    pending = false;
    // Retry using JS navigation as a fallback
    try { window.location.assign(GAS); } catch(e) {}
  }

  // Attach to both forms to schedule a retry if nothing happened
  ['openForm', 'adminForm'].forEach(id => {
    const f = document.getElementById(id);
    f.addEventListener('submit', () => {
      pending = true;
      // If the page hasn’t navigated after 900ms, try JS-based navigation.
      setTimeout(retryNav, 900);
    });
  });

  // Some webviews resume after visibility change; if still here, retry once.
  document.addEventListener('visibilitychange', () => {
    if (document.visibilityState === 'visible' && pending) {
      setTimeout(retryNav, 300);
    }
  });

  // Let user long-press → open in browser if still stuck
  document.getElementById('manual').addEventListener('click', () => { pending = false; });
</script>
